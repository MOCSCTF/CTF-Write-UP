# RTLXHA2021 - Prime Wars

- Write-Up Author: RB916120 \[[MOCTF](https://www.facebook.com/MOCSCTF)\]

- Flag:**RTL{th3r3_pr1m35_4nd_0pt1m4l_pr1m35_wh1ch_do_y0u_u53??-a1b8f0d453def3be67ebf3a313550f73e76951672b05b3bdd39da3e5}**

## **Question:**
> Prime Wars

```
There's a battle between Good and Evil and the Evil empires messaging system is not fully functioning. We've intercepted their message they had to send twice.

Author: H-mmer#8548
```

[chall.txt](./chall.txt)

## Write up
we can check the n on factordb.com</br> but no luck, we can't find the prime number. but lets see if we cloud find the GCD of n1 and n2, we can easily find P and Q.

[rsa modulus attack](https://ctf-wiki.org/crypto/asymmetric/rsa/rsa_module_attack/#_5)
[RSA Attacks: Common Modulus](https://infosecwriteups.com/rsa-attacks-common-modulus-7bdb34f331a5)

Obviously, we can find the GCD of them. we can lauch the RSA modulus attack as below code. 

```python
import libnum
n1 = 566221739863977646736721682011333807796590102966100695194310620218470729461275722292140482319899778713820060265923869893401521906205305368328306043579187706853485437921831371029214961811494122192337930065696018951462828665445615141091183534841940599838093770320461133391699075222247939819900121236110971700696105489971565251454461137332565728668519630702868390984968809890411002433675500435307965852077572726635810080149258801398685400547485878192424615765944731391973340241846002730195767759151858997916762387216730149076597675542290642832111947822631082336363112334980996139059508422962559340348499296207795252061098275087667409311341213411634790680066485631312469912396445799421274265217859663940963061971356082309326483768076487799281518290731656493691162323931795237278586585545623367010915334179583541995626560880636503957382134319206023123411349833472056481644952778792848785667709711485672892988797716902447369616972465400006278253452208972021357410241170776071179703665052803439192312431636333268490272499358694737414368063546325534729939683367397457925327583795681246653779995480876013766855878053276985288388511748855392360325294682863748252671552839924011611195986097044722822094665795811187083443436124185380849823320269
n2 = 530687960326989199343319641769468735056719687565676116773867349194199707584560078068423386135890862967492083649259423619534829360312312415859971577871205607317501227240337115190745493433956081180884413305800300580884184696296161434330167968026660523557985565886533238297825809579994229108489059297432098391309435372101680113632239869822673544784768505792706364410485518925618258042094875462603213572787841216570345262199686710412603549897422189614969582861864254420417299634404604836686002844474219985576430743265948197527474248491388705441130953941181556617683221203362472944098134461408751346998476446586666834971737908058449883435726587949913025269736607729697079862492284704316292035894525557178639119313839639367173374112578867607756303094321269575690336950882905280053919054235370449932609315382297618889670977059330701026607153879782197738829120356489708220812077499925959245646215072631870621249929738039796464674137188432418358322322951396160305358390892407264446374303126859071550310106586658423478700243720364032486757394301046359926113959148905015787118727956636757598958649450053440979270941138362644625329056253564482473075514932905256742399555775172390368620357545582366617322603645755305557295237798218160825818028141
c1 = 541153229095037579858295446778781172580884760385284002147542196003293531706169322960419234627569448144454740037897824182763794136447630757453376634579718740889293827421101038528096128202725311128856550252391329972697194691055771487521623294763797972162804659018656693772784475703082077246581189924112745802615273945459021693817260332729156074315476144345570299302453664151948339053713643786820031594973122213751914815311678013684404652242883165684206203052286412805274780026118894445296355748197875829240333586988104756334241102699330573777392273876291720218348933387763312640822902812957421714195326933601605321965709074451400653731014764106019599722795539834325135751763748535818245279349879282209883358546352004025727567368992723027658796034538642700094030498932061027265715879714641028273752382847514213009506808354344932707617158448818354068769701862616100339045667459331188727567895267106823657493354380767172450502114171361684932534502241769497123329590345257756472987942810598170216656539701267821411429342523220745000710941105058620823772704687332908554259583914517043335169990317116173107543607214237003882719965328248495192877057980130140435959212771456749734889259597913342498941690494257669128891366353841619609756468921
c2 = 254995434157499094074740522382653621037683865648217139039983930708198788191604658271710855356490733399654161006910038154620981573866101234344287987438243674727015451767752359204059726091404920699248900600731198907902943821415385868340903420608124994228491370751247056929503984979851323391697177354816426431850758247280384447390337838329405467881123751494398120341651866069192129528281599223102780529318685134788757786889067516080883688672346336894714129591857173409977371931952391183625743359104241029151189312962972792281315749538605826756768473316038049796835635589004389296836167765473708147029138883114826871178964183235758399250652660883721790259823584072358804375705646051403907609048390491677793908468748713509583596713778535934151102923682351421382031077628225365089849689017916396722184824218580154786982944998381313733006433456871650537316172524799446574879129947133779006211264007941650032669379067206952767031734008491060404429453666781467192068866951706138107308158417730524621195117216907305295460018473142138099891895507309673542435440468021685601317053971788683791808873561776467354349919631751772535099532988995232543637786525488499494159113757641523815672849159932102361116353214010806562143397856767159948326787376
e = 65537


def gcd(a, b):
   if a < b:
     a, b = b, a
   while b != 0:
     temp = a % b
     a = b
     b = temp
   return a

p=gcd(n1,n2)

q1=n1/p
q2=n2/p

phi_N1 = (p-1)*(q1-1)
phi_N2 = (p-1)*(q2-1)
d1 = libnum.modular.invmod(e,phi_N1)
d2 = libnum.modular.invmod(e,phi_N2)

ans1 = pow(c1,d1,n1)
ans2=pow(c2,d2,n2)
print(libnum.n2s(ans1))
print(libnum.n2s(int(str(ans1)+str(ans2))))
```

